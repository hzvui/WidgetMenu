# WidgetMenuUI — Интерактивное меню для управления моделью (ПК и VR)

Данный репозиторий содержит два компонента для движка Unigine, реализующих интерактивное меню, прикреплённое к 3D-объекту (`ObjectGui`). Меню позволяет управлять положением объектов, отображать информацию о деталях, управлять анимацией и визуальными лучами. Решение адаптировано для использования как в ПК-версии (с мышью), так и в VR-среде (с контроллерами).

<img width="1218" height="841" alt="image" src="https://github.com/user-attachments/assets/849c5a02-f7a5-476a-80b4-6a29fd397d40" />


## Компоненты

### 1. `PCWidgetMenuUIHand`
Компонент, предназначенный для ПК-версии. Создаётся на объекте типа `ObjectGui` и загружает пользовательский интерфейс из `.ui`-файла. Управление осуществляется виртуальной мышью.

**Основные возможности:**
- Кнопка **«Вернуть предметы обратно»** — вызывает метод `AllFullInitialTransform()` у компонента `DrugObject`, возвращающий все управляемые объекты в исходное положение.
- Кнопка **«Скрыть лучи» / «Показать лучи»** — переключает видимость лучей, отображаемых компонентом `CameraCast`.
- Кнопка **«Переместить всю модель» / «Остановить перемещение всей модели»** — включает/отключает режим перемещения всей модели целиком (флаг `movingAllObject` синхронизируется с `CameraCast` и с VR-версией меню).
- Кнопки управления анимацией:
  - **«Запуск анимации»** — запускает проигрывание анимации вперёд (через `AnimationSteps.Play()`).
  - **«Остановка анимации»** — останавливает анимацию.
  - **«Обратная анимация»** — запускает анимацию в обратном направлении.
- **Вкладка «Сведения о детали»**:
  - Отображает название детали (`detailNameLabel`).
  - Отображает подробное описание детали (`detailInfoLabel`), которое извлекается из компонента `DescriptionDetail`, прикреплённого к выбранному узлу. Если описание слишком длинное, в коде предусмотрена логика автоматического переноса строк (закомментирована, но может быть доработана).

### 2. `WidgetMenuUIHand`
Компонент для VR-версии. Функционально аналогичен `PCWidgetMenuUIHand`, но предназначен для взаимодействия через контроллеры в виртуальной реальности. Синхронизирует состояние кнопки перемещения всей модели с ПК-версией через ссылку `pCmenuUIHand`.

**Отличия от ПК-версии:**
- Использует собственный `ObjectGui`, но логика кнопок идентична.
- Переключение режима перемещения всей модели изменяет текст кнопки и синхронизирует флаг с ПК-компонентом, чтобы обеспечить согласованное поведение в обеих версиях приложения.

## Интерфейс (UI-файл)

Файл `*.ui` содержит разметку двух вкладок:

1. **«Основные функции»** — набор кнопок:
   - `initialButton`
   - `rayButton`
   - `movingAll`
   - `startAnimation`
   - `stopAnimation`
   - `reverseAnimation`

2. **«Сведения о детали»** — вертикальный контейнер с двумя текстовыми метками:
   - `detailNameLabel` — для названия детали.
   - `detailInfoLabel` — для подробного описания (поддержка переноса слов `wrap="1"`).

Интерфейс добавляется в иерархию GUI объекта `ObjectGui` и масштабируется по размеру родителя.

## Зависимости

Для корректной работы необходимы следующие компоненты и классы:

- `DrugObject` — управление трансформациями набора объектов (метод `AllFullInitialTransform`).
- `AnimationSteps` — управление анимацией (методы `Play`, `Stop`, `PlayReverse`).
- `CameraCast` — управление визуальными лучами (статическое поле `renderLine` и `movingAllObject`).
- `DescriptionDetail` — компонент, хранящий текстовое описание детали (поле `AddDescription`).
- `ObjectGui` — компонент Unigine для отображения GUI на 3D-объекте.

## Использование

1. Добавьте на сцену объект с компонентом `ObjectGui` (например, плоскость или модель планшета).
2. Прикрепите к этому объекту один из компонентов (`PCWidgetMenuUIHand` для ПК или `WidgetMenuUIHand` для VR).
3. В инспекторе укажите путь к `.ui`-файлу (например, `menu.ui`) и при необходимости назначьте ссылки на `DrugObject` и другие зависимости.
4. Убедитесь, что в сцене присутствуют компоненты `DrugObject`, `AnimationSteps`, `CameraCast` (они будут найдены автоматически через `FindComponentInWorld`).
5. Для отображения информации о детали вызовите методы `SetDetailName(string)` и `SetDetailInformation(Node)` из другого скрипта (например, при клике по детали).

## Примечания

- Компоненты синхронизируют состояние кнопки перемещения всей модели между ПК и VR через взаимные ссылки.
- В ПК-версии есть заготовка для автоматического переноса строк в описании, если ширина текста превышает ширину экрана `ObjectGui` (закомментированный код можно активировать при необходимости).
- Управление виртуальной мышью в ПК-версии включается установкой `objectGui.MouseMode = ObjectGui.MOUSE_VIRTUAL`.
